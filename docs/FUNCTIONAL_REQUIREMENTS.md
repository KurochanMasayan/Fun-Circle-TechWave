# 社内寄贈物管理システム - 機能要件定義書

## 1. システム概要

### 1.1 システムの目的
社内に寄贈された書籍・備品を効率的に管理し、社員間での共有・活用を促進するWebアプリケーション

### 1.2 対象ユーザー
- **一般ユーザー**: 全社員（寄贈物の検索・貸出・レビュー）
- **管理者**: 総務部門（寄贈物の登録・管理・統計確認）
- **システム管理者**: IT部門（ユーザー管理・システム設定）

## 2. 機能一覧

### 2.1 ユーザー管理機能

#### 2.1.1 認証機能
- **Google OAuth認証**
  - 社内Googleアカウントでのシングルサインオン
  - 初回ログイン時の自動ユーザー登録
  - セッション管理（有効期限：7日間）

#### 2.1.2 権限管理
- **権限レベル**
  - 一般ユーザー: 閲覧・貸出・レビュー
  - 管理者: 上記 + 寄贈物登録・編集・削除
  - システム管理者: 全機能 + ユーザー管理

#### 2.1.3 プロフィール管理
- プロフィール情報の表示・編集
- 貸出履歴の確認
- お気に入り登録した寄贈物の管理

### 2.2 寄贈物管理機能

#### 2.2.1 寄贈物登録
- **基本情報**
  - 品名（必須）
  - カテゴリ（必須）: 書籍/備品/その他
  - サブカテゴリ（任意）
  - 寄贈者情報（任意）
  - 寄贈日（必須）

- **書籍の場合の追加情報**
  - ISBN（任意）
  - 著者名（必須）
  - 出版社（任意）
  - 出版年（任意）
  - ジャンル（必須）

- **備品の場合の追加情報**
  - メーカー（任意）
  - 型番（任意）
  - 購入時期（任意）
  - 状態（必須）: 新品/良好/普通/要注意

- **共通追加情報**
  - 保管場所（必須）
  - 備考（任意）
  - 画像（任意、最大3枚）

#### 2.2.2 寄贈物編集・削除
- 登録情報の編集（管理者のみ）
- 論理削除の実装（物理削除は不可）
- 編集履歴の保持

#### 2.2.3 在庫管理
- 貸出可能/貸出中のステータス管理
- 複数在庫がある場合の数量管理
- 保管場所の変更履歴

### 2.3 検索・一覧表示機能

#### 2.3.1 検索機能
- **キーワード検索**
  - 品名、著者、出版社での部分一致検索
  - 複数キーワードでのAND/OR検索

- **絞り込み検索**
  - カテゴリ別
  - ステータス別（貸出可能/貸出中）
  - 保管場所別
  - 評価別（★4以上など）
  - 寄贈日範囲

#### 2.3.2 一覧表示
- **表示形式**
  - グリッドビュー（画像付き）
  - リストビュー（詳細情報付き）

- **ソート機能**
  - 新着順
  - 人気順（貸出回数）
  - 評価順
  - 名前順（五十音）

- **ページネーション**
  - 1ページ20件表示
  - ページ番号での移動
  - 前後ページへの移動

### 2.4 貸出・返却管理機能

#### 2.4.1 貸出申請
- ワンクリック貸出申請
- 貸出期間の選択（1週間/2週間/1ヶ月）
- 利用目的の入力（任意）
- 貸出承認の自動化（一般書籍）
- 特定物品の承認フロー（高額備品等）

#### 2.4.2 返却処理
- 返却ボタンによる簡単返却
- 返却確認の管理者承認
- 延長申請機能（最大2回まで）

#### 2.4.3 貸出履歴管理
- 個人の貸出履歴表示
- 物品別の貸出履歴表示
- 期限超過アラート表示

### 2.5 レビュー・評価機能

#### 2.5.1 評価機能
- 5段階評価（★1〜★5）
- 評価は返却後のみ可能
- 平均評価の自動計算・表示

#### 2.5.2 レビュー機能
- テキストレビュー（最大1000文字）
- レビューへの「役立った」ボタン
- 不適切なレビューの報告機能

#### 2.5.3 おすすめ機能
- 管理者によるおすすめ設定
- カテゴリ別人気ランキング
- 新着おすすめの表示

### 2.6 通知機能

#### 2.6.1 システム内通知
- 貸出承認通知
- 返却期限リマインダー（3日前、当日）
- 予約可能通知

#### 2.6.2 メール通知（オプション）
- 返却期限超過通知
- 重要なお知らせ

### 2.7 統計・レポート機能

#### 2.7.1 利用統計
- 月別貸出数推移
- カテゴリ別利用率
- 人気ランキング（TOP10）

#### 2.7.2 在庫レポート
- カテゴリ別在庫数
- 未利用物品リスト
- 紛失・破損レポート

## 3. 非機能要件

### 3.1 パフォーマンス
- ページ読み込み：3秒以内
- 検索結果表示：2秒以内
- 同時接続数：100ユーザー

### 3.2 セキュリティ
- HTTPS通信の強制
- SQLインジェクション対策
- XSS対策
- CSRF対策

### 3.3 ユーザビリティ
- レスポンシブデザイン（PC/タブレット/スマホ対応）
- 直感的なUI設計
- アクセシビリティ対応（WCAG 2.1 Level AA準拠）

### 3.4 可用性
- 稼働率：99.9%以上
- 計画メンテナンス：月1回以内
- バックアップ：日次自動実行

## 4. 画面一覧

### 4.1 共通画面
- ログイン画面
- ヘッダー（ナビゲーション）
- フッター

### 4.2 メイン画面
- ダッシュボード（トップページ）
- 寄贈物一覧画面
- 寄贈物詳細画面
- 検索結果画面

### 4.3 ユーザー画面
- マイページ
- 貸出履歴画面
- お気に入り一覧画面

### 4.4 管理画面
- 寄贈物登録画面
- 寄贈物編集画面
- ユーザー管理画面
- 統計ダッシュボード

## 5. 外部インターフェース

### 5.1 認証連携
- Google OAuth 2.0

### 5.2 書籍情報API（将来実装）
- Google Books API
- openBD API

### 5.3 通知連携（将来実装）
- Slack API
- Microsoft Teams API

## 6. データ要件

### 6.1 マスタデータ
- カテゴリマスタ
- 保管場所マスタ
- ジャンルマスタ

### 6.2 トランザクションデータ
- 貸出履歴（3年間保持）
- レビューデータ（無期限保持）
- アクセスログ（1年間保持）

## 7. 制約事項

### 7.1 技術的制約
- Cloudflare Workersの実行時間制限（50ms）
- Supabaseの無料枠制限
- 画像アップロードサイズ（最大5MB/枚）

### 7.2 運用的制約
- 初期データ移行は手動対応
- 24時間サポートは提供しない
- 英語対応は将来検討

---

*作成日：2025年1月10日*
*更新日：2025年1月10日*